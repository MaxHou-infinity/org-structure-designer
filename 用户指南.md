# 组织架构设计工具使用指南

## 数据准备

在使用本工具之前，您需要准备两个Excel文件：

1. 员工信息文件
2. 组织架构文件

请按照下面的格式准备您的数据。

### 员工信息文件格式

文件应包含以下列：

| 列名 | 说明 | 示例 |
|-----|------|------|
| 姓名 | 员工姓名 | 张三 |
| 工号 | 员工工号 | EMP001 |
| 职级 | 员工职级 | P6 |
| 一级部门 | 最高层级部门 | 总裁办 |
| 二级部门 | 二级部门 | 人力资源部 |
| 三级部门 | 三级部门 | 招聘组 |
| 四级部门 | 四级部门（可选） | - |
| 五级部门 | 五级部门（可选） | - |
| 六级部门 | 六级部门（可选） | - |

### 组织架构文件格式

文件应包含以下列：

| 列名 | 说明 | 示例 |
|-----|------|------|
| 一级部门 | 最高层级部门 | 总裁办 |
| 二级部门 | 二级部门 | 人力资源部 |
| 三级部门 | 三级部门 | 招聘组 |
| 四级部门 | 四级部门 | - |
| 五级部门 | 五级部门 | - |
| 六级部门 | 六级部门 | - |
| 部门级别 | 部门层级（1-6） | 2 |
| 部门负责人工号 | 负责人工号 | EMP001 |
| 部门负责人 | 负责人姓名 | 张三 |

## 使用流程

1. **启动应用**
   - Windows：双击运行 `start.bat`
   - Mac/Linux：运行 `sh start.sh`
   - 浏览器将自动打开应用页面

2. **导入数据**
   - 点击"上传"按钮
   - 选择您准备好的Excel文件
   - 等待数据导入完成

3. **生成组织架构图**
   - 点击"生成组织架构图"按钮
   - 等待图表生成

4. **查看和编辑**
   - 使用鼠标拖动调整视图
   - 使用右上角的缩放按钮调整大小
   - 点击部门右上角的箭头展开/折叠子部门

5. **修改组织架构**
   - 拖拽员工到其他部门
   - 右键点击创建虚拟员工
   - 双击修改部门名称
   - 点击部门负责人进行修改

6. **导出结果**
   - 点击"导出组织架构图"保存为图片
   - 点击"保存Excel文件"导出数据

## 功能说明

### 拖拽功能
- 点击并按住员工块可以拖动
- 拖动到目标部门后释放鼠标
- 系统会自动更新员工所属部门

### 虚拟员工
- 右键点击任意位置
- 选择"创建虚拟员工"
- 输入虚拟员工信息
- 可以像普通员工一样拖动
- 右键点击可以删除虚拟员工

### 部门管理
- 双击部门名称可以编辑
- 点击部门负责人可以更换
- 使用搜索框快速查找员工

### 视图控制
- 使用鼠标滚轮或触控板缩放
- 点击空白处拖动整个视图
- 使用全部展开/折叠按钮控制显示

## 注意事项

1. **数据格式**
   - 确保Excel文件格式正确
   - 工号必须唯一
   - 部门名称要准确匹配

2. **浏览器兼容性**
   - 推荐使用 Chrome 或 Firefox
   - 确保浏览器已更新到最新版本

3. **性能优化**
   - 建议每次导入数据不超过1000条
   - 展开/折叠操作可能需要等待

4. **数据备份**
   - 重要修改后及时导出保存
   - 定期备份数据文件

## 故障排除

1. **应用无法启动**
   - 检查Python环境是否正确安装
   - 确认所有依赖包已安装
   - 查看错误日志

2. **数据导入失败**
   - 检查Excel文件格式
   - 确认文件未被其他程序占用
   - 检查文件编码格式

3. **图表显示异常**
   - 刷新页面
   - 清除浏览器缓存
   - 重新导入数据

4. **操作无响应**
   - 检查网络连接
   - 重启应用
   - 清理浏览器缓存

如遇到其他问题，请提交 Issue 获取帮助。 