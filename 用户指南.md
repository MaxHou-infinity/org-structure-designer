# 组织架构设计工具 - 用户指南

## 目录

1. [简介](#简介)
2. [安装步骤](#安装步骤)
3. [基本操作](#基本操作)
4. [高级功能](#高级功能)
5. [数据格式说明](#数据格式说明)
6. [常见问题解答](#常见问题解答)

## 简介

组织架构设计工具是一个简单易用的应用程序，帮助您可视化管理公司的组织结构。通过直观的界面，您可以导入现有的组织数据，进行编辑和调整，并导出更新后的结果。

### 主要功能

- 导入员工信息和组织架构数据
- 可视化展示组织架构
- 拖拽调整员工所属部门
- 创建虚拟员工进行组织规划
- 修改部门名称和负责人
- 导出组织架构图和更新后的数据

## 安装步骤

### Windows用户

1. 下载本项目到您的电脑
2. 双击运行 `install.bat` 文件安装必要的依赖
   - 如果您没有安装Python，安装程序会提示您先安装Python
   - 安装Python时请勾选"Add Python to PATH"选项
3. 安装完成后，双击 `start.bat` 启动应用
4. 浏览器将自动打开应用页面 (http://127.0.0.1:5000)

### Mac/Linux用户

1. 下载本项目到您的电脑
2. 打开终端，进入项目目录
3. 运行 `sh install.sh` 安装必要的依赖
   - 如果您没有安装Python，安装程序会提示您先安装Python
4. 安装完成后，运行 `sh start.sh` 启动应用
5. 浏览器将自动打开应用页面 (http://127.0.0.1:5000)

## 基本操作

### 1. 准备数据文件

在使用本工具前，您需要准备两个Excel文件：

- **员工信息文件**：包含员工的基本信息和所属部门
- **组织架构文件**：包含部门结构和负责人信息

您可以在`examples`目录中找到模板文件，按照模板格式准备您的数据。

### 2. 导入数据

1. 启动应用后，在左侧面板找到"数据导入"区域
2. 点击"选择文件"按钮，选择您准备好的员工信息Excel文件
3. 点击"上传"按钮上传员工信息
4. 同样的方式上传组织架构Excel文件
5. 两个文件都上传成功后，"生成组织架构图"按钮将被启用

### 3. 生成组织架构图

点击"生成组织架构图"按钮，系统将根据您上传的数据生成可视化的组织架构图。

### 4. 导出结果

完成编辑后，您可以：

- 点击"导出组织架构图"按钮将当前视图保存为PNG图片
- 点击"保存Excel文件"按钮导出更新后的Excel数据

## 高级功能

### 调整组织架构

#### 拖拽员工

您可以直接拖动员工到其他部门，改变其所属关系：

1. 鼠标悬停在员工上，光标会变为"可移动"状态
2. 按住鼠标左键拖动员工
3. 将员工拖到目标部门的员工区域
4. 释放鼠标，员工将被移动到新部门

#### 创建虚拟员工

虚拟员工功能可以帮助您规划组织结构变更：

1. 右键点击现有员工
2. 在弹出的菜单中选择"创建虚拟员工"
3. 系统将创建一个虚拟员工副本（带有虚线边框标识）
4. 您可以拖动虚拟员工到不同部门进行规划

#### 删除虚拟员工

1. 右键点击虚拟员工
2. 在弹出的菜单中选择"删除虚拟员工"

#### 修改部门名称

1. 双击部门名称
2. 输入新的部门名称
3. 按回车键或点击其他区域确认修改

#### 修改部门负责人

1. 点击部门负责人信息
2. 在弹出的搜索框中输入员工姓名或工号
3. 从搜索结果中选择新的负责人

### 调整视图

#### 展开/折叠部门

- 点击部门右上角的箭头图标可以展开或折叠该部门的子部门
- 使用右上角的"全部展开"和"全部折叠"按钮可以一次性展开或折叠所有部门

#### 缩放组织架构图

使用右上角的缩放控件调整组织架构图的大小：

- 点击"+"按钮放大视图
- 点击"-"按钮缩小视图
- 点击"⟳"按钮重置缩放比例

## 数据格式说明

### 员工信息文件

员工信息Excel文件需包含以下列：

| 列名 | 说明 | 示例 |
|------|------|------|
| 姓名 | 员工姓名 | 张三 |
| 工号 | 员工工号 | 10001 |
| 职级 | 员工职级 | L3.1 |
| 一级部门 | 所属一级部门 | 总裁办 |
| 二级部门 | 所属二级部门 | 人力资源部 |
| 三级部门 | 所属三级部门 | 招聘组 |
| 四级部门 | 所属四级部门 |  |
| 五级部门 | 所属五级部门 |  |
| 六级部门 | 所属六级部门 |  |

### 组织架构文件

组织架构Excel文件需包含以下列：

| 列名 | 说明 | 示例 |
|------|------|------|
| 一级部门 | 一级部门名称 | 总裁办 |
| 二级部门 | 二级部门名称 | 人力资源部 |
| 三级部门 | 三级部门名称 | 招聘组 |
| 四级部门 | 四级部门名称 |  |
| 五级部门 | 五级部门名称 |  |
| 六级部门 | 六级部门名称 |  |
| 部门级别 | 部门级别 | 3 |
| 部门负责人工号 | 负责人工号 | 10001 |
| 部门负责人 | 负责人姓名 | 张三 |

## 常见问题解答

### Q: 如何处理大型组织架构？

A: 对于大型组织，建议：
- 使用缩放功能调整视图大小
- 折叠不需要查看的部门
- 按部门层级分别导出图片

### Q: 员工没有显示在正确的部门中怎么办？

A: 请检查Excel文件中员工的部门信息是否正确填写。员工会显示在其最深层级的部门中。

### Q: 如何批量修改员工所属部门？

A: 目前不支持批量修改。您可以：
1. 在Excel文件中修改后重新导入
2. 在界面中逐个拖动员工到目标部门

### Q: 导出的Excel文件与原始文件格式不同怎么办？

A: 导出的Excel文件保留了所有必要的数据列，但可能会丢失原始文件中的格式设置。您可以在Excel中重新设置格式。

### Q: 应用无法启动怎么办？

A: 请检查：
1. 是否已安装Python 3.7或更高版本
2. 是否已运行安装脚本
3. 查看控制台输出的错误信息

如果问题仍然存在，请联系技术支持。 